<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Exemplo cliente da API</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px; }
    input, textarea { width: 100%; padding: 8px; margin: 6px 0; box-sizing: border-box; }
    button { padding: 8px 12px; margin: 6px 4px; }
    pre { background:#f6f6f6; padding:10px; }
  </style>
</head>
<body>
  <h1>Cliente exemplo para API</h1>
  <p>Altera <code>API_BASE</code> se necessário.</p>

  <script>
    const API_BASE = 'http://localhost:3000'; // alterar para a tua URL onrender quando deployado
  </script>

  <section>
    <h2>Criar (POST)</h2>
    <input id="create-title" placeholder="Título" />
    <textarea id="create-content" placeholder="Conteúdo"></textarea>
    <button onclick="createItem()">Criar</button>
  </section>

  <section>
    <h2>Listar (GET)</h2>
    <button onclick="listItems()">Atualizar lista</button>
    <pre id="list-output">Nada carregado</pre>
  </section>

  <section>
    <h2>Atualizar (PUT)</h2>
    <input id="put-id" placeholder="ID do item" />
    <input id="put-title" placeholder="Novo título" />
    <textarea id="put-content" placeholder="Novo conteúdo"></textarea>
    <button onclick="updateItem()">Atualizar</button>
    <pre id="put-output"></pre>
  </section>

  <section>
    <h2>Apagar (DELETE)</h2>
    <input id="del-id" placeholder="ID do item" />
    <button onclick="deleteItem()">Apagar</button>
    <pre id="del-output"></pre>
  </section>

  <script>
    async function listItems() {
      try {
        const res = await fetch(`${API_BASE}/data`);
        const data = await res.json();
        document.getElementById('list-output').textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById('list-output').textContent = 'Erro: ' + err;
      }
    }

    async function createItem() {
      const title = document.getElementById('create-title').value;
      const content = document.getElementById('create-content').value;
      try {
        const res = await fetch(`${API_BASE}/data`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ title, content })
        });
        const json = await res.json();
        alert('Criado: ' + json.id);
        listItems();
      } catch (err) {
        alert('Erro: ' + err);
      }
    }

    async function updateItem() {
      const id = document.getElementById('put-id').value;
      const title = document.getElementById('put-title').value;
      const content = document.getElementById('put-content').value;
      try {
        const res = await fetch(`${API_BASE}/data/${encodeURIComponent(id)}`, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ title, content })
        });
        const json = await res.json();
        document.getElementById('put-output').textContent = JSON.stringify(json, null, 2);
        listItems();
      } catch (err) {
        document.getElementById('put-output').textContent = 'Erro: ' + err;
      }
    }

    async function deleteItem() {
      const id = document.getElementById('del-id').value;
      try {
        const res = await fetch(`${API_BASE}/data/${encodeURIComponent(id)}`, {
          method: 'DELETE'
        });
        const json = await res.json();
        document.getElementById('del-output').textContent = JSON.stringify(json, null, 2);
        listItems();
      } catch (err) {
        document.getElementById('del-output').textContent = 'Erro: ' + err;
      }
    }

    // Carrega lista ao abrir
    listItems();
  </script>
</body>
</html>